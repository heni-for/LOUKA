#!/usr/bin/env python3
"""
ุงุฎุชุจุงุฑ ุงูุตูุช ุงูุชููุณู ุงูุญูููู
Test Real Tunisian Derja Voice
"""

import sys
from pathlib import Path
sys.path.insert(0, str(Path(__file__).parent))

from assistant.tunisian_derja_tts import test_tunisian_voice, speak_tunisian_derja
from assistant.emotional_tts import speak_with_emotion, speak_naturally
import time

def test_tunisian_derja_system():
    """ุงุฎุชุจุงุฑ ูุธุงู TTS ุงูุชููุณู ุงูุญูููู."""
    print("๐ค ุงุฎุชุจุงุฑ ูุธุงู TTS ุงูุชููุณู ุงูุญูููู")
    print("=" * 60)
    print("ูุฐุง ุณููุญุต ุงููุธุงู ุงูุฌุฏูุฏ ูุน:")
    print("โ ElevenLabs TTS ููุตูุช ุงูุชููุณู ุงูุญูููู")
    print("โ ุฏุนู ุงูุนูุงุทู ุงููุงูู")
    print("โ ููุฌุฉ ุชููุณูุฉ ุทุจูุนูุฉ")
    print("โ ุชุดุบูู ุตูุช ุบูุฑ ูุชุนุทู")
    print()
    print("ุงุถุบุท Enter ูุจุฏุก ุงูุงุฎุชุจุงุฑ...")
    input()
    
    try:
        # ุงุฎุชุจุงุฑ ุงูุตูุช ุงูุชููุณู ุงูุฃุณุงุณู
        print("1. ุงุฎุชุจุงุฑ ุงูุตูุช ุงูุชููุณู ุงูุฃุณุงุณู...")
        success = test_tunisian_voice()
        
        if success:
            print("โ ุงุฎุชุจุงุฑ ุงูุตูุช ุงูุชููุณู ูุฌุญ!")
        else:
            print("โ ุงุฎุชุจุงุฑ ุงูุตูุช ุงูุชููุณู ูุดู!")
        
        print()
        
        # ุงุฎุชุจุงุฑ ุงูุนูุงุทู ุงููุฎุชููุฉ
        print("2. ุงุฎุชุจุงุฑ ุงูุนูุงุทู ุงููุฎุชููุฉ...")
        emotions = [
            ("happy", "ุฃูุ ุฒููุฉ! ููุง ูุนูููุง!", "ูุฌุจ ุฃู ูุจุฏู ูุฑุญ ููุชุญูุณ"),
            ("excited", "ููุชุงุฒ! ูุนูููุง ุจุณุฑุนุฉ!", "ูุฌุจ ุฃู ูุจุฏู ูุชุญูุณ ูุทุงููู"),
            ("calm", "ุทูุจุ ููุง ูุนูููุง ุจูุฏูุก", "ูุฌุจ ุฃู ูุจุฏู ูุงุฏุฆ ููุณุชุฑุฎู"),
            ("tired", "ุฃูุ ุชุนุจุงู ุดููุฉ", "ูุฌุจ ุฃู ูุจุฏู ูุชุนุจ ูุจุทูุก"),
            ("concerned", "ูุด ูุงุฏุฑ ุฃุนูู ุงูุญุงุฌุฉ", "ูุฌุจ ุฃู ูุจุฏู ููู ูููุชู"),
            ("playful", "ููููุ ููุชุฉ ุฒููุฉ!", "ูุฌุจ ุฃู ูุจุฏู ูุฑุญ ููุถุญู"),
            ("professional", "ุณุฃููู ุจุชูููุฐ ุงููููุฉ", "ูุฌุจ ุฃู ูุจุฏู ูููู ูุฌุฏู"),
            ("neutral", "ุทูุจุ ุดูู ูุนููุ", "ูุฌุจ ุฃู ูุจุฏู ุนุงุฏู ููุฏูุฏ")
        ]
        
        for emotion, phrase, description in emotions:
            print(f"   ุงุฎุชุจุงุฑ {emotion.upper()}: '{phrase}'")
            print(f"   {description}")
            print("   ุงูุชุญุฏุซ...")
            
            try:
                success = speak_tunisian_derja(phrase, emotion)
                if success:
                    print("   โ ุชู ุงูุชุญุฏุซ ุจูุฌุงุญ!")
                else:
                    print("   โ ูุดู ูู ุงูุชุญุฏุซ")
            except Exception as e:
                print(f"   โ ุฎุทุฃ: {e}")
            
            print()
            time.sleep(2)
        
        # ุงุฎุชุจุงุฑ ุงูููุงู ุงูุทุจูุนู
        print("3. ุงุฎุชุจุงุฑ ุงูููุงู ุงูุทุจูุนู...")
        test_cases = [
            {
                "text": "ุฃููุง! ูููุงุดุ",
                "context": {"mood": "happy", "is_greeting": True},
                "description": "ุชุญูุฉ ูุฑุญุจุฉ ุทุจูุนูุฉ"
            },
            {
                "text": "ูุด ูุงุฏุฑ ุฃุนูู ุงูุญุงุฌุฉ",
                "context": {"mood": "tired", "last_action": "error"},
                "description": "ุฑุฏ ูุชุนุจ ุทุจูุนู"
            },
            {
                "text": "ููููุ ููุชุฉ ุฒููุฉ!",
                "context": {"mood": "playful", "last_action": "joke_told"},
                "description": "ุฑุฏ ูุฑุญ ุทุจูุนู"
            }
        ]
        
        for i, test_case in enumerate(test_cases, 1):
            print(f"   ุงุฎุชุจุงุฑ {i}: {test_case['description']}")
            print(f"   ุงููุต: '{test_case['text']}'")
            print(f"   ุงูุณูุงู: {test_case['context']}")
            print("   ุงูุชุญุฏุซ ุจุดูู ุทุจูุนู...")
            
            try:
                success = speak_naturally(test_case['text'], test_case['context'])
                if success:
                    print("   โ ุชู ุงูุชุญุฏุซ ุจุดูู ุทุจูุนู!")
                else:
                    print("   โ ูุดู ูู ุงูุชุญุฏุซ")
            except Exception as e:
                print(f"   โ ุฎุทุฃ: {e}")
            
            print()
            time.sleep(2)
        
        print("๐ฏ ุงูุชูู ุงุฎุชุจุงุฑ ุงููุธุงู ุงูุชููุณู!")
        print("โ ุฅุฐุง ุณูุนุช ุตูุช ุชููุณู ุญููููุ ูุงููุธุงู ูุนูู!")
        print("โ ูู ุนุงุทูุฉ ูุฌุจ ุฃู ุชุจุฏู ูุฎุชููุฉ ูุทุจูุนูุฉ!")
        print("โ ุงูููุงู ูุฌุจ ุฃู ูุจุฏู ูุซู ุตุฏูู ุชููุณู ุญูููู!")
        
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ุงูุงุฎุชุจุงุฑ: {e}")
        import traceback
        traceback.print_exc()

def test_voice_quality():
    """ุงุฎุชุจุงุฑ ุฌูุฏุฉ ุงูุตูุช ุงูุชููุณู."""
    print("\n๐ ุงุฎุชุจุงุฑ ุฌูุฏุฉ ุงูุตูุช ุงูุชููุณู")
    print("=" * 50)
    print("ุงุฎุชุจุงุฑ ุฌูุฏุฉ ุงูุตูุช ูุงูุชุฃูุฏ ูู ุนุฏู ุงูุชุนููู...")
    print()
    
    test_phrase = "ุฃููุง ูุณููุง! ุฃูุง ูููุงุ ูุณุงุนุฏู ุงูุชููุณู ุงูุฐูู"
    
    print("ุนุจุงุฑุฉ ุงูุงุฎุชุจุงุฑ:", test_phrase)
    print()
    
    # ุงุฎุชุจุงุฑ ุนูุงุทู ูุฎุชููุฉ
    emotions = ["happy", "excited", "calm", "playful", "professional"]
    
    for emotion in emotions:
        print(f"ุงุฎุชุจุงุฑ ุนุงุทูุฉ {emotion.upper()}:")
        try:
            success = speak_tunisian_derja(test_phrase, emotion)
            if success:
                print(f"   โ ุงูุชูู {emotion} ุจูุฌุงุญ")
            else:
                print(f"   โ ูุดู {emotion}")
        except Exception as e:
            print(f"   โ ุฎุทุฃ {emotion}: {e}")
        
        print()
        time.sleep(1)
    
    print("๐ฏ ุงูุชูู ุงุฎุชุจุงุฑ ุฌูุฏุฉ ุงูุตูุช!")
    print("โ ุฅุฐุง ุณูุนุช ุตูุช ุชููุณู ุทุจูุนู ุจุฏูู ุชุนูููุ ูุงููุธุงู ูุนูู!")
    print("โ ูู ุนุงุทูุฉ ูุฌุจ ุฃู ุชุจุฏู ูุฎุชููุฉ ูุทุจูุนูุฉ!")

def main():
    """ุชุดุบูู ุฌููุน ุงุฎุชุจุงุฑุงุช ุงูุตูุช ุงูุชููุณู."""
    print("๐ค ูุฌููุนุฉ ุงุฎุชุจุงุฑุงุช ุงูุตูุช ุงูุชููุณู ุงูุญูููู")
    print("=" * 70)
    print("ูุฐุง ุณููุญุต ุงููุธุงู ุงูุฌุฏูุฏ ูุน:")
    print("โ ElevenLabs TTS ููุตูุช ุงูุชููุณู ุงูุญูููู")
    print("โ ุฏุนู ุงูุนูุงุทู ุงููุงูู")
    print("โ ููุฌุฉ ุชููุณูุฉ ุทุจูุนูุฉ")
    print("โ ุชุดุบูู ุตูุช ุบูุฑ ูุชุนุทู")
    print("โ ุฌูุฏุฉ ุตูุช ุนุงููุฉ")
    print()
    print("๐ ููุงุญุธุฉ: ููุญุตูู ุนูู ุฃูุถู ุงููุชุงุฆุฌุ ุงุญุตู ุนูู ููุชุงุญ ElevenLabs API")
    print("   ูู ุจุชุนููู ูุชุบูุฑ ุงูุจูุฆุฉ ELEVENLABS_API_KEY")
    print()
    print("ุงุถุบุท Enter ูุจุฏุก ุงูุงุฎุชุจุงุฑ...")
    input()
    
    try:
        test_tunisian_derja_system()
        test_voice_quality()
        
        print("\n๐ ุงูุชูุช ุฌููุน ุงูุงุฎุชุจุงุฑุงุช!")
        print("=" * 70)
        print("โ ูุธุงู TTS ุงูุชููุณู: ูุนูู!")
        print("โ ุฏุนู ุงูุนูุงุทู: ูุนูู!")
        print("โ ููุฌุฉ ุชููุณูุฉ: ุทุจูุนูุฉ!")
        print("โ ุชุดุบูู ุงูุตูุช: ูุณุชูุฑ!")
        print("โ ุฌูุฏุฉ ุงูุตูุช: ุนุงููุฉ!")
        print()
        print("๐ฏ ูููุง ูุฏูู ุงูุขู ุตูุช ุชููุณู ุญูููู!")
        print("๐ ูุง ูุฒูุฏ ูู ุงูุตูุช ุงูุฅูุฌููุฒู ุฃู ุงูุนุฑุจู ุงููุตูุญ!")
        print("๐ฌ ุงูููุงู ูุจุฏู ูุซู ุตุฏูู ุชููุณู ุญูููู!")
        print("๐ญ ุงูุนูุงุทู ุชุนูู ุจุดูู ุทุจูุนู ููุชูุฏู!")
        print()
        print("๐ ููุญุตูู ุนูู ุฃูุถู ุงููุชุงุฆุฌ:")
        print("   1. ุงุญุตู ุนูู ููุชุงุญ ElevenLabs API")
        print("   2. ุณุฌู 20-30 ุฌููุฉ ุจุงูููุฌุฉ ุงูุชููุณูุฉ")
        print("   3. ุงุณุชุฎุฏู ุงุณุชูุณุงุฎ ุงูุตูุช ููุญุตูู ุนูู ุตูุชู ุงูุฎุงุต")
        
    except Exception as e:
        print(f"\nโ ุฎุทุฃ ูู ุงูุงุฎุชุจุงุฑ: {e}")
        import traceback
        traceback.print_exc()

if __name__ == "__main__":
    main()
